<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JarvisX Admin Panel</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 2rem;
        background-color: #f4f4f4;
      }
      #messages {
        background: #fff;
        padding: 1rem;
        margin-bottom: 1rem;
        border-radius: 5px;
        max-height: 400px;
        overflow-y: auto;
      }
      .bubble {
        margin-bottom: 10px;
        padding: 10px;
        border-radius: 5px;
      }
      .user {
        background-color: #e0f7fa;
      }
      .bot {
        background-color: #fce4ec;
      }
    </style>
  </head>
  <body>
    <h2>ðŸ§  JarvisX Training Panel</h2>
    <div id="messages"></div>
    <textarea
      id="prompt"
      rows="3"
      style="width: 100%"
      placeholder="Ask JarvisX something..."
    ></textarea>
    <br /><br />
    <button onclick="sendPrompt()">Send</button>

    <script>
      const messagesDiv = document.getElementById("messages");

      async function sendPrompt() {
        const prompt = document.getElementById("prompt").value;
        if (!prompt.trim()) return;

        // Show user prompt
        const userDiv = document.createElement("div");
        userDiv.className = "bubble user";
        userDiv.innerText = "ðŸ‘¤ You: " + prompt;
        messagesDiv.appendChild(userDiv);

        document.getElementById("prompt").value = "";

        try {
          const res = await fetch("/admin/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ prompt }),
          });

          const data = await res.json();
          const reply = data.reply || "âš  No reply.";

          // Show bot reply
          const botDiv = document.createElement("div");
          botDiv.className = "bubble bot";
          botDiv.innerText = "ðŸ¤– JarvisX: " + reply;
          messagesDiv.appendChild(botDiv);

          messagesDiv.scrollTop = messagesDiv.scrollHeight;
        } catch (err) {
          alert("âš  Failed to send message.");
        }
      }
    </script>
  </body>
</html>
